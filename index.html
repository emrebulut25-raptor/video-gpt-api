<script>
document.getElementById("analyzeForm").addEventListener("submit", async (e) => {
    e.preventDefault();
    const fileInput = document.getElementById("video");
    const lang = document.getElementById("lang").value;
    const resultDiv = document.getElementById("result");
    resultDiv.innerHTML = "⏳ Analiz ediliyor...";

    const formData = new FormData();
    formData.append("file", fileInput.files[0]);
    formData.append("lang", lang);

    try {
        const response = await fetch("https://video-gpt-api-1.onrender.com/analyze_video", {
            method: "POST",
            body: formData
        });

        if (!response.ok) {
            resultDiv.innerHTML = "❌ Sunucu hatası: " + response.status;
            return;
        }

        const data = await response.json();
        console.log("Gelen veri:", data);

        // Türkçe dahil çok dilli sonuç formatı
        let html = `<h3>${data.message}</h3>`;
        html += `<p><b>🎞️ Sahne sayısı:</b> ${data.scene_count}</p>`;
        html += `<p><b>⏱️ Süre:</b> ${data.total_duration}s</p>`;

        html += `<ul>`;
        data.scenes.forEach((scene, i) => {
            html += `
            <li>
              🕒 <b>${scene.scene_start}s → ${scene.scene_end}s</b><br>
              <b>Duygu:</b> ${scene.emotion}<br>
              <b>Prompt:</b> ${scene.prompt}
            </li>`;
        });
        html += `</ul>`;
        resultDiv.innerHTML = html;

    } catch (error) {
        console.error("Hata:", error);
        resultDiv.innerHTML = "❌ Hata oluştu: " + error.message;
    }
});
</script>
